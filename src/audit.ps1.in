#Requires -RunAsAdministrator

# Version: //VERSION
# DateTime: //DATE //TIME

//include "functions/hardware_readiness.ps1"


<# HELPER FUNCTIONS #>

//include "functions/helper.ps1"


<# INITIAL SETUP #>

Write-Out "Audit script version //VERSION`n" -ForegroundColor Green

$global:warnings = @()

$rocksaltPath = "C:\Rocksalt"

# Ensure rocksalt directory exists
if (-not (Test-Path -Path $rocksaltPath)) {
  New-Item -ItemType Directory -Path $rocksaltPath | Out-Null
  Write-Out "Rocksalt directory created: $rocksaltPath"
}
else {
  Write-Out "Rocksalt directory already exists: $rocksaltPath"
}


<# AUDIT INFORMATION #>

//include "functions/audit_info.ps1"


<# BRUTE FORCE PROTECTION #>

Write-Out "`n=== Running brute force commands ===`n" -ForegroundColor DarkYellow
net accounts /lockoutthreshold:10 /lockoutwindow:5 /lockoutduration:30 | Out-Null


<# TEAMVIEWER #>

//include "functions/teamviewer.ps1"


<# ROCKSALT USER #>

//include "functions/rocksalt_user.ps1"


<# WINDOWS 11 COMPATIBLE #>

//include "functions/windows11_compatible.ps1"


<# BITLOCKER #>

//include "functions/bitlocker.ps1"


<# AUDITER INPUT #>

//ifdef INPUT
//include "functions/audit_input.ps1"
//endif


<# OUTPUT #>

Write-Out "`n=== Output ===`n" -ForegroundColor DarkYellow

if ($warnings.Count -gt 0 -and (Read-Y "Would you like to add warnings to notes?")) {
  $notes = if ($notes) { "$notes; " } else { "" }
  $notes += "Warnings: $($warnings -join ', ')"
}

//ifdef NORMAL
//include "output/normal.ps1"
//endif
//ifdef ACTION1
//include "output/action1.ps1"
//endif
//ifdef DATA_SOURCE
//include "output/data_source.ps1"
//endif
//ifdef CUSTOM_ATTRIBUTES
//include "output/custom_attributes.ps1"
//endif
